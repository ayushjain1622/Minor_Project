# -*- coding: utf-8 -*-
"""Heart failure prediction system

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1VqqxqQqk3TC1Md0otZbfHYrzHWiA_jbt

IMPORTING LIBRARIES
"""

import numpy as np
import pandas as pd

"""READING THE DATASET"""

data_s=pd.read_csv('heart_failure_data_1.csv')

data_s.head()

"""GROUPING DATASET"""

data_s.groupby('Target Label').size()

data_s.describe()

"""LABEL ASSIGNING"""

X=data_s.iloc[:,0:10].values
Y=data_s.iloc[:,11].values
print(X[:,1])

"""Label Envoding"""

from sklearn.preprocessing import LabelEncoder
LEncoder=LabelEncoder()
y=LEncoder.fit_transform(Y)

"""Splitting dataset into train and test"""

from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test=train_test_split(X,y,test_size=0.10,random_state=15)

"""Feature Scaling"""

from sklearn.preprocessing import StandardScaler
scaler=StandardScaler()
X_train=scaler.fit_transform(X_train)
X_test=scaler.fit_transform(X_test)

"""Training and prediction for classification using Random Forest"""

from sklearn.ensemble import RandomForestClassifier
classifier=RandomForestClassifier()
classifier.fit(X_train,y_train)
y_pred=classifier.predict(X_test)
print(y_pred)

acc=classifier.score(X_test,y_test)
print(acc)

from sklearn.metrics import classification_report,confusion_matrix
import seaborn as sns
classes_names=['class 1', 'class 2']
cm=pd.DataFrame(confusion_matrix(y_test,y_pred),columns=classes_names,index=classes_names)
sns.heatmap(cm,annot=True,fmt='d');
print(classification_report(y_test,y_pred))

